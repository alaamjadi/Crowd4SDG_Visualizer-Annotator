<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Image Filtering</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="main.js"></script>

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>

<body>
    <div class="container">
        <!-- Three columns of text below the carousel -->
        <div class="row">
            <div class="d-flex justify-content-center col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4">
            </div>

            <div class="d-flex justify-content-center col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4">
            </div>

            <div class="d-flex justify-content-center col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4">
            </div>
        </div>
    </div>

    <div id='fileNames'>M</div>
    <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            Select The CSV File
        </button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#">Item 1</a>
        </div>
    </div>
    <div id="fileNames"></div>
    <script type="text/javascript">//<![CDATA[
        $(window).load(function(){
           var fileExt = ".csv";
        
                $(document).ready(function(){
        
                    $.ajax({
                        //This will retrieve the contents of the folder if the folder is configured as 'browsable'
                        url: 'csv/',
                        success: function (data) {
                            console.log(data);
                           $("#fileNames").html('<ul>');
                           //List all xml file names in the page
        
                            //var filename = this.href.replace(window.location, "").replace("http:///", "");
                           //$("#fileNames").append( '<li>'+filename+'</li>');
        
                            $(data).find("a:contains(" + fileExt + ")").each(function () {
                                $("#fileNames").append( '<li>'+$(this).text()+'</li>');
                            });
                            $("#fileNames").append('</ul>');
                        }
                    });
        
                });
        });
        //]]>
        </script>
    <script>
        var array = [];

        

        function check_box(cb) {
            tweet_id = cb.id;
            $(tweet_id).trigger('change');
        }


        function handleClick(tweet_id) {
            array.push(tweet_id);
        }

        function buttonClick() {

            var csv = 'tweet_id\n';
            for (var i = 0; i < array.length; i++) /*csvAsArray.length*/ {
                csv += array[i] + '\n';
            }

            var filename = 'false_positives.csv';

            if (!csv.match(/^data:text\/csv/i)) {
                csv = 'data:text/csv;charset=utf-8,' + csv;
            }
            
            var data = encodeURI(csv);
            
            var link = document.createElement('a');
            link.setAttribute('href', data);
            link.setAttribute('download', filename);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }


        $(document).ready(function () {

            $.ajax({
                url: "no_people.csv",
                dataType: 'text',
                cache: false
            }).done(function (csvAsString) {
                csvAsArray = csvAsString.csvToArray();
                for (var j = 0; j < csvAsArray.length - 1; j += 4) {
                    if (j > 0) {
                        var multi = document.createElement('div');
                        multi.className = 'multipl-image-checkbox';
                        multi.style.display = 'inline-block';

                        for (var i = 0; i < 4; i++) /*csvAsArray.length*/ {
                            row = csvAsArray[j + i] + '';
                            split = row.split(',');
                            tweet_id = split[0];
                            url = split[1];
                            tag = split[2];


                            var ul = document.createElement('ul');

                            var li = document.createElement('li');
                            li.style.display = 'inline-block';
                            var checkbox = document.createElement('input');
                            checkbox.setAttribute('type', 'checkbox');
                            checkbox.setAttribute('onclick', 'handleClick(' + tweet_id + ')');
                            checkbox.id = tweet_id;


                            var label = document.createElement('label');
                            label.setAttribute('for', 'check');
                            label.innerText = tag;
                            label.style.textAlign = 'center';


                            var img = document.createElement('img');
                            img.setAttribute('src', url);
                            img.setAttribute('width', "160px");
                            img.setAttribute('height', "160px");
                            img.setAttribute('title', tweet_id);
                            img.setAttribute('onclick', 'check_box(tweet_id)');


                            label.appendChild(img);
                            li.appendChild(checkbox);
                            li.appendChild(label);
                            ul.appendChild(li);
                            multi.appendChild(ul);

                        }
                        document.body.appendChild(multi);
                    }

                }
                var button = document.createElement("BUTTON");
                var t = document.createTextNode("Submit answers");
                button.appendChild(t);
                button.setAttribute('onclick', 'buttonClick()');
                document.body.appendChild(button);


            });

        });

    </script>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>

</body>

</html>